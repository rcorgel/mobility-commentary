# mobility-commentary

We simulated a population composed of 50 patches, with patch population size drawn from a scaled gamma distribution, and x- and y- coordinates drawn independently from two uniform distributions. We considered the population in each of the patches to be a composite of two populations, adults and children, which had different travel patterns. For each patch, the proportion of the population that is children was drawn from a uniform distribution, with bounds of 40% and 50%. The number of trips $T_ij$ between origin patch $i$ and destination patch $j$, for population $N_i$ (adults or children) followed an exponential gravity distribution, namely $T_ij = \theta (N_i^\omega_1 N_j^\omega_2 / exp(d_ij/\delta))$, where $N_i$ is the number of adults or children in origin patch $i$, $N_j$ is the number of adults or children in destination patch $j$, and  $D_ij$ is the distance between two patches. We had set the destination population attraction exponent $\omega_1$ to be three times more for children than for adults, meaning that children were more likely to travel to more populous places than adults. On the other hand, the distance deterrent coefficient $\delta$ was 10 times higher for children than adults; that is, children were less likely to travel to patches that were further apart than adults.   
The probability of departure from each patch was drawn from a truncated normal distribution. For children, we set the mean probability of departure to 0.02, with standard deviation of 0.02; for adults, the mean probability of departure was set to 0.2, with standard deviation of 0.04. All probabilities of departure smaller than 0.00001 were replaced with 0.001. Probabilities of travel from patch $i$ to $j$, where $i \neq j$, were scaled so that the sum of probabilities of travel from $i$ to all patches $j$ was equal to 1 minus the probability of remaining in $i$. 
To generate the “true” mobility matrix, capturing probability of travel between patches on a daily basis, we divided the estimated number of total trips taken by children and adults from $i$ to $j$ by the total number of trips from origin $i$  (including those remaining in the patch). 
 
### Adult-only mobility matrix
We considered a situation where only travel by the adult population is observed. This may be the case of a travel survey that only targets adults, or mobility datasets like mobile phone data, if mobile phones are only carried by adults. In this matrix, the diagonal, or the probability of remaining within patch, was equal to the probability of departure by adults only. The off-diagonals, representing the probability of travel from patch $i$ to $j$, were calculated as for the “true” mobility matrix, but restricted to the adult population; that is, probability of travel from $i$ to $j$ was equal to the number of trips $T_ij$ for adults, scaled so that the sum of off-diagonal probabilities for origin $i$ was equal to 1 minus the probability of remaining in the patch. 
 
### Censored mobility matrix
Some mobility data sets, such as mobile phone data and Facebook data, use censoring to reduce the risk of identifiability and protect the privacy of individuals in the dataset. To represent this scenario, we censored travel between patches $i$ and $j$ where the total number of trips in the “true” mobility matrix was less than 900. We then rescaled the off-diagonal probabilities of travel so that the total sum for probability of travel from patch $i$ was equal to 1 minus the probability of remaining in the patch. 
 
### Weekly mobility matrix
We calculated the weekly probability of departure from each patch as $1 - exp(-p_i(t) * 7)$, where  $p_i(t)$ is the daily probability of departure from the patch, as obtained from the “true” mobility matrix. We then obtained the weekly mobility matrix by setting the diagonal to 1 minus the weekly probability of departure, and scaling the off-diagonals so that the total sum of probabilities of travel from each patch was equal to 1 minus probability of remaining within the patch. 
 
### Regional travel matrix 
We used k-means clustering approach to group the patches into five regions. A regional travel matrix was obtained by aggregating all trips between patches as obtained in the “true” mobility matrix, and calculate probabilities of travel between regions as before.  
 

## Disease transmission simulations
To assess the impact of using different mobility matrices, we used a stochastics, discrete-time, metapopulation compartmental model, with susceptible, infectious, and recovered compartments. We assumed frequency-dependent transmission, and set $R0$ to 1.5, and 3-day duration of infectiousness. We seeded initial infections into the most populous patch, and ran 100 simulations for each mobility matrix, averaging number of cases across simulations. We calculated spatial arrival time as the time from beginning of simulation to the time of arrival in patch or region; for patch-level simulations, this was the time to at least 5 average cumulative cases, and for region-level simulations, this was time to 50 average cumulative cases. 
